var btnClicked=!1;function buttonClicked(e){var t={type:"clickResponse",buttonClicked:btnClicked=!btnClicked};chrome.tabs.sendMessage(e.id,t)}function getIMDBRating(o){return new Promise(function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==this.readyState&&200==this.status)return e(this.responseText)};var i=o.split(" ").join("+");n.open("GET",_imdb_api_url+i+_imdb_apikey,!0),n.send()})}function resetContextOptions(){chrome.contextMenus.removeAll(function(){chrome.contextMenus.create({contexts:["selection"],onclick:handleSelect,title:"Search IMDb: '%s'"})})}function handleSelect(e,t){chrome.tabs.create({url:_imdb_web_url+e.selectionText,selected:!0,index:t.index+1})}chrome.browserAction.onClicked.addListener(buttonClicked),chrome.runtime.onMessage.addListener(function(e,t,n){if("callAPI"==e.type)return getIMDBRating(e.text).then(function(e){data=JSON.parse(e),data.Error?console.log("No movie Found"):(data.type="ratingResponse",chrome.tabs.query({active:!0,currentWindow:!0},function(e){chrome.tabs.sendMessage(e[0].id,data)}))}),!0}),resetContextOptions();